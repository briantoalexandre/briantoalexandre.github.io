from os import rename, listdir as ld, path
from time import sleep as sl
from customtkinter import *
from functools import partial as par



def VerifyFile():
    global Path
    while True:
        try:
            with open("path.txt", "r") as readfile:
                Path = [readfile.read()]
                if "\n" in Path[0]:
                    Path = Path[0].split(sep="\n")
                break
        except FileNotFoundError:
            with open("path.txt", "x") as writefile:
                writefile.write(".")
                continue


class Window(CTk):
    def __init__(self):
        super().__init__()
        self.geometry("450x300")
        self.title("File_Name_Modifi2er")
        
        self.Path = Path
        self.Extension = ".mp3"
        self.Filelist = []

        def Get_File_Name(event):
            for a in Path:
                if path.exists(a):
                    for b in ld(a):
                        if self.Extension in b:
                            print(b)
                        else:
                            continue
                else:
                    continue
        def Get_File_Number(event):
            c = 0
            for a in Path:
                if path.exists(a):
                    for b in ld(a):
                        if self.Extension in b:
                            c += 1
                        else:
                            continue
                else:
                    continue
            print(c)
        def Add_Path_Into_File(event):
            try:
                self.warnlabel.pack_forget()
            except:
                None
            self.warnlabel = CTkLabel(self.line3, text="" ,font=self.fonte, text_color="red")
            NewPath = self.entry.get()
            self.entry.select_clear()
            if path.exists(NewPath) == True and NewPath not in Path and NewPath != "..":
                try:
                    with open("path.txt", "a") as NewPathWriteFile:
                        NewPathWriteFile.write("\n"+NewPath.lower())
                        self.warnlabel.configure(text="added path with no issues", text_color="green")

                except FileNotFoundError:
                    VerifyFile()
                    self.warnlabel.configure(text="An issue occurred please try again")
            else:
                self.warnlabel.configure(text="An issue occurred, path doesn't even exist LMAO")
            self.warnlabel.pack()


        def Enable_Disable(event, line):
            if line.cget("fg_color") == self.cget("fg_color"):
                line.configure(fg_color="gray82")
            else:
                line.configure(fg_color=self.cget("fg_color"))

        def APPMAINGOAL(event):
            sl(5)
            if self.entryreplace.get() != "":
                value = self.entryreplace.get()
                print(type(value))
                if self.check2.get() == 0: #Add
                    for paths in Path:
                        if path.exists(paths):
                            for files in ld(paths):
                                if self.Extension in files:
                                    old = paths+"/"+files
                                    print(paths + "/" + value + files)
                                    if int(self.entrycheck1.get()) == 0:
                                        if self.combobox.get() == "LEFT":
                                            new = paths + "/" + value + files
                                        elif self.combobox.get() == "RIGHT":
                                            new = paths + "/" + files[:files.index(".mp3")] + value +files[files.rindex("."):]
                                    else:
                                        new = old
                                    rename(src=old, dst=new)


                elif self.check2.get() == 1: #Remove

                    for paths in Path:
                        if path.exists(paths):
                            for files in ld(paths):
                                if self.Extension in files:
                                    try:
                                        old = paths+"/"+files
                                        new = paths+"/"+files.split(value, 1)[0]+files.split(value, 1)[1]
                                        rename(src=old, dst=new)
                                    except IndexError:
                                        continue

            if self.check1.get() == 1:
                if self.entrycheck1.get() == "" or self.entrycheck1.get().isdigit() == True:
                    if self.entrycheck1.get() == "":
                        value2 = 1
                    else:
                        value2 = int(self.entrycheck1.get())

                    for paths in Path:
                        if path.exists(paths):
                            for files in ld(paths):
                                if self.Extension in files:
                                    old = paths + "/" + files
                                    if self.combobox.get() == "LEFT":
                                        new = paths + "/" + files[value2:]
                                    elif self.combobox.get() == "RIGHT":
                                        new = paths + "/" + files[:-value2-4]+".mp3"
                                    rename(src=old, dst=new)




                else:
                    print("eee")
            else:
                None
        
        self.font = CTkFont(size=26)
        self.fonte = CTkFont(size=20)
        self.line1 = CTkFrame(self, fg_color=self.cget("fg_color"))
        self.button = CTkLabel(self.line1, text="get file name", font=self.font)
        self.button.bind(sequence="<Button-1>", command=Get_File_Name)
        self.button2 = CTkLabel(self.line1, text="get file number", font=self.font)
        self.button2.bind(sequence="<Button-1>", command=Get_File_Number)
        self.line2 = CTkFrame(self, fg_color=self.cget("fg_color"))
        self.entry = CTkEntry(self.line2, placeholder_text="C:/...", font=self.font, width=300)
        self.entrybutton = CTkLabel(self.line2, text="Verify", font=self.font)
        self.entrybutton.bind(sequence="<Button-1>", command=Add_Path_Into_File)
        self.line3 = CTkFrame(self, fg_color=self.cget("fg_color"), height=5)
        self.line4 = CTkFrame(self, fg_color=self.cget("fg_color"))
        self.entryreplace = CTkEntry(self.line4, placeholder_text="- word -", font=self.font, width=200)
        self.buttonstart = CTkLabel(self.line4, text="START", font=self.font, text_color="#059f05", bg_color="#10Df10")
        self.buttonstart.bind(sequence="<Button-1>", command=APPMAINGOAL)
        self.line5 = CTkFrame(self, fg_color="gray82")
        self.check1 = CTkCheckBox(self.line5, text="", font=self.fonte, width=0)
        self.check1.bind(sequence="<Button-1>", command=par(Enable_Disable, line=self.line5))
        self.textlabelremove = CTkLabel(self.line5, text="Remove ", font=self.fonte)
        self.entrycheck1 = CTkEntry(self.line5, placeholder_text="1", width=30, font=self.font)
        self.textlabelremove2 = CTkLabel(self.line5, text=" from the ", font=self.fonte)
        self.combobox = CTkOptionMenu(self.line5, values=("LEFT", "RIGHT"), font=self.font, fg_color="#F9F9FA", button_color="#F9F9FA", text_color="gray52", hover=False, corner_radius=0)
        self.line6 = CTkFrame(self, fg_color=self.cget("fg_color"))
        self.check2 = CTkCheckBox(self.line6, text="Add/Remove", font=self.fonte, width=0)
        self.check2.select()

        self.line1.pack(fill="x")
        self.button.grid(row=0, column=0, sticky=W)
        self.button2.grid(row=0, column=1, padx=25, sticky=W)

        self.line2.pack(fill="x")
        self.entry.grid(row=0, column=0, sticky=W)
        self.entrybutton.grid(row=0, column=1, padx=5)

        self.line3.pack(side="bottom", fill="x")

        self.line4.pack(fill="x")
        self.entryreplace.grid(row=0, column=0)
        self.buttonstart.grid(row=0, column=1, padx=5)

        self.line5.pack(fill="x")
        self.check1.grid(row=0, column=0)
        self.textlabelremove.grid(row=0, column=1)
        self.entrycheck1.grid(row=0, column=2)
        self.textlabelremove2.grid(row=0, column=3)
        self.combobox.grid(row=0, column=4)

        self.line6.pack(fill="x")
        self.check2.grid(row=0)


VerifyFile()
Main = Window()
Main.mainloop()